{% extends 'base.html' %}
{% block title %}Home{% endblock %}
{% load static %}
{% load crispy_forms_tags %}
{% block content %}
<div class="album py-5 bg-body-tertiary">
    <div class="container">
        <button type="submit" class="btn btn-info" id="random_recipes_button">Refresh random recipes</button>
        <div class="py-5 bg-body-tertiary">
            <p>Insert ingredients in english and separate them with ',' (e.g.:eggs, milk, pasta).</p>
            <form method="post">
                {% csrf_token %}
                {{ form|crispy }}
                <button type="submit" class="btn btn-info">Add ingredients</button>
            </form>
        </div>
    <div class="row row-cols-1 row-cols-sm-2 row-cols-md-3 g-3">
        {% include 'recipe_block_extended.html' %}
    </div>
    </div>
</div>

<script type="text/javascript">

    var button = document.getElementById('random_recipes_button')
    button.addEventListener("click", getRandomRecipes)

    function getRandomRecipes(){
        var url = 'http://127.0.0.1:8000/api/recipes-random/'

        fetch(url).then((resp) => resp.json()).then(function(data){
            console.log(data)

            for (let i = 0; i < 2; i++){
                document.getElementById('recipe_image'+i).src = data[i][1]
                document.getElementById('recipe_title'+i).innerHTML = data[i][0]
                document.getElementById('recipe_minutes'+i).innerHTML = data[i][3] + ' minutes to prepare'
                document.getElementById('recipe_servings'+i).innerHTML = data[i][4] + ' servings'

                

            }



        })

    }
    

</script>


{% endblock %}